HW 5
================
Jake Vettoretti
2025-11-06

``` r
library(broom)
library(tidyverse)
```

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.4     ✔ readr     2.1.5
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.1
    ## ✔ ggplot2   3.5.2     ✔ tibble    3.3.0
    ## ✔ lubridate 1.9.4     ✔ tidyr     1.3.1
    ## ✔ purrr     1.1.0     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

``` r
set.seed(1)
```

## Problem 1

``` r
# Define simulation function
bday_sim = function(n_room) {
  birthdays = sample(1:365, n_room, replace = TRUE)
  repeated_bday = length(unique(birthdays)) < n_room
  return(repeated_bday)
}

# Run simulation for group sizes 2–50, with 10,000 iterations each
bday_sim_results = 
  expand_grid(
    bdays = 2:50,
    iter = 1:10000
  ) |> 
  mutate(
    result = map_lgl(bdays, bday_sim) #returns logical vector
  ) |> 
  group_by(
    bdays
  ) |> 
  summarize(
    prob_repeat=mean(result)
  )

bday_sim_results
```

    ## # A tibble: 49 × 2
    ##    bdays prob_repeat
    ##    <int>       <dbl>
    ##  1     2      0.0024
    ##  2     3      0.0085
    ##  3     4      0.0167
    ##  4     5      0.0267
    ##  5     6      0.0399
    ##  6     7      0.0521
    ##  7     8      0.0751
    ##  8     9      0.0925
    ##  9    10      0.116 
    ## 10    11      0.139 
    ## # ℹ 39 more rows

``` r
# Plot results
bday_sim_results |> 
  ggplot(aes(x = bdays, y = prob_repeat)) +
  geom_point() +
  geom_line() +
  labs(
    x = "Group size (n)",
    y = "Probability of shared birthday",
    title = "Probability that at least two people share a birthday"
  ) +
  theme_minimal()
```

![](p8105_hw5_jpv2129_files/figure-gfm/unnamed-chunk-2-1.png)<!-- -->

Comments: The plot shows that the probability that at least two people
share a birthday increases quickly as the number of people in the room
grows. When only a few people are present the chance of a shared
birthday is very small but the probability rises sharply as the group
becomes larger. Around twenty three people the probability reaches about
fifty percent and by forty people it is close to one hundred percent.
This finding illustrates the birthday paradox where even small groups
have a surprisingly high chance of sharing a birthday because the number
of possible pairs increases rapidly with group size.

## Question 2

Part 1, mu = 0

``` r
#Setting the design elements
n = 30        # sample size
sigma = 5     # population SD
mu = 0        # true mean
n_sims = 5000 # number of simulated datasets

#Part 1, simulate 5000 datasets and test H0: mu=0
sim_mu0 =
  tibble(iter = 1:n_sims) |>
  mutate(
    results = map(iter, \(i) {
      tibble(x = rnorm(n, mean = mu, sd = sigma)) |>
        summarize(test = list(tidy(t.test(x, mu = 0)))) |>
        unnest(cols = c(test)) |>
        select(estimate, p.value)
    })
  ) |>
  unnest(cols = c(results))


#Part 1, checking model

sim_mu0 |>
  summarize(
    avg_mu_hat = mean(estimate),
    sd_mu_hat  = sd(estimate),
    type1error_rate = mean(p.value < 0.05)
  )
```

    ## # A tibble: 1 × 3
    ##   avg_mu_hat sd_mu_hat type1error_rate
    ##        <dbl>     <dbl>           <dbl>
    ## 1    0.00500     0.911            0.05

Part 2, mu = 1:6

``` r
n = 30
sigma = 5
mu_values = 1:6
n_sims = 5000

# Repeat simulation for each μ
sim_results =
  map_df(mu_values, \(m) {
    tibble(iter = 1:n_sims) |>
      mutate(
        results = map(iter, \(i) {
          tibble(x = rnorm(n, mean = m, sd = sigma)) |>
            summarize(test = list(tidy(t.test(x, mu = 0)))) |>
            unnest(cols = c(test)) |>
            select(estimate, p.value)
        })
      ) |>
      unnest(cols = c(results)) |>
      mutate(mu = m)
  })

# Check one example
sim_results |> 
  group_by(mu) |> 
  summarize(power = mean(p.value < 0.05))
```

    ## # A tibble: 6 × 2
    ##      mu power
    ##   <int> <dbl>
    ## 1     1 0.187
    ## 2     2 0.569
    ## 3     3 0.887
    ## 4     4 0.987
    ## 5     5 0.999
    ## 6     6 1
